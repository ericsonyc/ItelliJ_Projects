from matplotlib import pyplot as plt
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

plt.rcParams['text.usetex'] = True
plt.rcParams['mathtext.default'] = 'bf'
plt.rcParams['lines.linewidth'] = 2
plt.rcParams['font.size'] = 12

# fig = plt.figure()
# ax = Axes3D(fig)
x = [0]
temp = 0.5
for i in range(8):
    x.append(x[i] + temp)
x = x[1:]
y = [i + 1 for i in range(30)]

# z = [[1, 2, 3, 4, 5, 6, 7, 8, 9], [9, 8, 7, 6, 5, 4, 3, 2, 1], [12, 23, 34, 45, 56, 67, 78, 89, 90]]
z1 = [[318.682, 236.141, 204.847, 182.572, 170.474, 166.522, 159.616, 160.905, 154.072, 162.899, 190.536, 149.556,
       148.474, 155.054, 150.709, 159.856, 154.183, 152.528, 148.514, 145.907, 142.776, 143.637, 199.238, 145.681,
       145.619, 158.328, 146.630, 144.003, 142.572, 141.477],

      [306.321, 245.144, 255.052, 180.037, 171.656, 166.827, 164.716, 160.678, 158.714, 158.668, 159.608, 156.704,
       155.146, 153.261, 154.847, 151.873, 150.755, 145.938, 142.641, 147.159, 146.613, 146.645, 143.562, 141.519,
       145.826, 142.755, 141.053, 199.829, 148.287, 143.596],

      [312.540, 282.048, 206.759, 182.709, 176.660, 168.597, 158.129, 205.884, 204.906, 153.945, 151.791, 152.415,
       155.567, 146.653, 147.950, 152.685, 146.005, 149.651, 147.639, 152.230, 147.083, 142.656, 143.556, 142.627,
       141.773, 147.425, 144.594, 142.713, 148.838, 148.937],

      [299.737, 292.280, 205.757, 184.521, 176.759, 202.186, 199.534, 155.821, 155.402, 156.753, 152.463, 149.998,
       150.567, 149.664, 148.073, 148.237, 144.719, 143.689, 141.496, 147.201, 144.163, 148.407, 153.141, 146.725,
       159.250, 166.318, 211.181, 199.637, 223.943, 253.363],

      [356.101, 309.744, 285.119, 225.583, 195.929, 224.469, 171.582, 165.970, 162.202, 161.669, 157.128, 156.063,
       154.636, 152.649, 149.824, 180.753, 180.522, 162.333, 186.760, 166.423, 163.199, 183.762, 168.398, 187.942,
       208.456, 185.559, 196.852, 178.272, 229.177, 214.916],

      [323.700, 236.099, 207.255, 186.002, 176.097, 165.769, 161.031, 161.243, 167.363, 150.187, 154.375, 155.677,
       149.062, 149.232, 151.126, 148.439, 159.247, 159.669, 156.002, 159.893, 157.695, 160.921, 159.932, 162.561,
       161.980, 164.361, 154.198, 162.149, 159.858, 155.667],

      [304.846, 244.522, 205.471, 189.679, 174.234, 171.658, 164.675, 162.767, 158.151, 164.610, 155.122, 155.787,
       163.375, 166.670, 164.826, 160.265, 161.907, 161.295, 158.949, 156.257, 162.183, 200.120, 160.508, 155.721,
       158.650, 167.452, 160.381, 163.318, 159.406, 163.890]]

z2 = [[178.431, 147.571, 107.968, 89.410, 73.763, 67.748, 63.317, 59.635, 56.597, 54.323, 54.757, 53.690, 48.768,
       47.696, 48.144, 46.599, 46.702, 49.388, 47.559, 47.206, 46.813, 45.661, 47.489, 45.937, 46.763, 45.633,
       46.095, 47.264, 46.548, 45.475],

      [183.951, 145.553, 104.334, 85.663, 75.573, 69.001, 62.723, 58.621, 58.732, 55.282, 50.939, 53.389, 51.713,
       49.390, 48.376, 47.226, 46.780, 46.089, 48.233, 48.200, 45.631, 46.672, 47.917, 47.702, 44.484, 44.753,
       46.316, 46.639, 46.528, 46.671],

      [179.232, 142.279, 104.176, 90.132, 74.798, 66.646, 62.855, 86.966, 54.984, 55.965, 50.964, 52.783, 52.106,
       48.421, 50.964, 48.655, 48.116, 47.741, 47.557, 46.619, 46.722, 47.778, 47.917, 45.691, 46.811, 45.570, 44.955,
       47.264, 44.612, 44.685],

      [184.701, 147.071, 107.179, 87.994, 76.603, 69.362, 63.255, 60.266, 56.746, 54.047, 52.903, 49.743, 50.726,
       48.738, 48.062, 48.802, 46.650, 48.655, 47.750, 47.753, 46.687, 45.905, 45.738, 47.900, 46.371, 45.213,
       47.213, 44.602, 44.800, 46.667],

      [181.229, 139.768, 104.048, 87.216, 76.907, 68.235, 62.716, 58.196, 57.721, 56.981, 52.803, 52.099, 50.708,
       47.746, 46.745, 47.705, 47.208, 46.155, 49.398, 46.755, 49.797, 51.759, 54.113, 53.773, 54.378, 55.655, 52.737,
       51.784, 50.911, 51.620],

      [174.055, 141.265, 105.977, 87.893, 74.227, 66.635, 63.752, 57.243, 55.967, 56.192, 51.593, 50.561, 49.238,
       49.185, 48.314, 48.524, 46.489, 45.255, 49.614, 51.864, 50.151, 53.165, 53.186, 53.861, 54.368, 55.555, 53.925,
       52.220, 52.529, 52.214],

      [175.502, 149.719, 105.079, 84.709, 73.830, 67.916, 60.969, 60.069, 56.386, 53.626, 54.488, 50.528, 52.664,
       52.279, 52.028, 55.713, 58.882, 61.459, 57.981, 59.712, 58.478, 58.602, 57.306, 53.449, 57.753, 58.637, 57.354,
       56.878, 57.878, 58.748]]

z3 = [[237, 205, 227, 218, 212, 247, 192, 222, 204, 213, 198, 249, 209, 212, 206, 226, 229, 234, 231, 236, 254, 220,
       225, 222, 219, 244, 233, 188, 231, 212],

      [306, 289, 200, 284, 152, 153, 268, 203, 126, 124, 125, 149, 147, 150, 130, 284, 122, 111, 128, 113, 101,
       114, 124, 147, 128, 147, 127, 118, 148, 108],

      [314, 301, 190, 280, 150, 147, 149, 282, 126, 124, 128, 145, 149, 150, 128, 307, 127, 104, 129, 105, 103, 109,
       128, 147, 127, 149, 131, 121, 156, 108],

      [220, 298, 181, 275, 145, 138, 145, 300, 125, 120, 119, 146, 142, 148, 124, 280, 119, 99, 121, 104, 126, 122,
       147, 125, 146, 128, 114, 140, 100, 121],

      [289, 300, 188, 281, 145, 149, 144, 279, 128, 121, 124, 147, 141, 149, 121, 312, 120, 101, 121, 100, 103, 102,
       119, 140, 120, 142, 122, 123, 141, 101],

      [278, 289, 198, 276, 147, 148, 149, 286, 130, 125, 127, 151, 146, 151, 128, 291, 126, 127, 131, 124, 123, 124,
       126, 157, 128, 138, 127, 125, 145, 127],

      [311, 307, 180, 281, 144, 145, 152, 296, 131, 128, 128, 132, 152, 152, 150, 135, 281, 132, 121, 131, 122, 122,
       124, 126, 156, 130, 144, 132, 131, 129]]

# ax.axis([0, 4, 0, 31])
# ax.set_xticklabels([])
# ax.set_yticklabels([])
temp = 260

for i in range(len(z1)):
    for j in range(len(z1[0])):
        z1[i][j] += temp
        z2[i][j] += temp

# for i in range(1):  # number of z array
#     for j in range(len(x) - 1):  # number of x array
#         temp = [x[j] for t in range(len(y))]
#         ax.scatter(temp, y, z1[j], c='g', marker='^')
#         ax.scatter(temp, y, z2[j], marker='o', c='r')
#         ax.scatter(temp, y, z3[j], marker='o', c='y')

# for i in range(len(z1)):
#     for j in range(len(x)):
#         temp = [x[j] for t in range(len(y))]
#         output = [4 for k in range(len(y))]
#         ax.scatter(temp, y, output, c='g')

# ax.scatter(x, y, Z1, c='g')
# ax.scatter(X, Y, Z2, c='r')

# ax.set_ylabel('Reduce Number')
# ax.set_xlabel('Container Memory(G)')
# ax.set_zlabel('Time(s)')
# plt.show()
# plt.savefig("H:\\rdma_shuffle\\data\\pktm\\out1.eps")

print(len(y))
print(len(z1[0]))

plta=plt.subplot(411)
pltb=plt.subplot(412)
pltc=plt.subplot(413)
pltd=plt.subplot(414)

plta.plot(y, z1[0], color='magenta')
plta.plot(y, z2[0], color='red')
plta.plot(y, z3[0], color='blue')

pltb.plot(y, z1[1], color='magenta')
pltb.plot(y, z2[1], color='red')
pltb.plot(y, z3[1], color='blue')

pltc.plot(y, z1[4], color='magenta')
pltc.plot(y, z2[4], color='red')
pltc.plot(y, z3[4], color='blue')

pltd.plot(y, z1[3], color='magenta')
pltd.plot(y, z2[3], color='red')
pltd.plot(y, z3[3], color='blue')

# plt.ylabel('Time(s)', fontsize=16)
# plt.xlabel('Reduce Number', fontsize=16)
# plta.xlim(0, 35)
# plta.ylim(150, 800)
# leg = plta.legend([plt1, plt2, plt3], ['Original Hadoop', 'Alter Hadoop', 'Alter Spark'])
# leg=plta.legend()
# leg.get_frame()
# plt.show()
plt.savefig("H:\\rdma_shuffle\\data\\pktm\\out1.eps")
